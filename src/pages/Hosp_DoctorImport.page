<apex:page id="Hosp_DoctorImport" controller="Hosp_DoctorImportController">

    <apex:form id="firstForm">

        <apex:outputPanel id="messages">
            <apex:pageMessages showDetail="false"/>
        </apex:outputPanel>


        <apex:pageBlock title="{! $Label.Doctors_import }"
                        mode="edit">

            <apex:pageBlockSection columns="2">

                <apex:inputFile value="{! csvFileBody }"
                                filename="{! csvAsString }"
                                contentType="{! contentType }"/>
            </apex:pageBlockSection>

            <apex:outputPanel>

                <div style="text-align: center;">

                    <apex:commandButton value="{! $Label.Process }"
                                        action="{! importCSVFile }"/>
                </div>
            </apex:outputPanel>
        </apex:pageBlock>
    </apex:form>


    <apex:form id="apexForm">

        <apex:pageBlock id="doctorsTable" rendered="{! doneUploading }">

            <apex:outputPanel rendered="{! !doctorsFromFile.empty }">

                <apex:commandButton value="{! $Label.SelectAll }"
                                    action="{! selectAllCheckBoxes }"
                                    reRender="apexForm"
                                    status="statusComp"/>

                <apex:commandButton value="{! $Label.ClearAll }"
                                    action="{! clearAllCheckBoxes }"
                                    reRender="apexForm"
                                    status="statusComp"/>

                <apex:commandButton value="{! $Label.Hosp_Revert_Selection }"
                                    action="{! revertCheckBoxes }"
                                    reRender="apexForm"
                                    status="statusComp"/>
            </apex:outputPanel>

            <apex:pageBlockTable id="doctorColumn"
                                 value="{! doctorsFromFile }" var="oneDoctor"
                                 rendered="{! !doctorsFromFile.empty }">

                <apex:column headerValue="{! $Label.Start_Import }">

                    <apex:inputCheckbox id="checkBox" value="{! oneDoctor.isSelectedWrapper }"/>
                </apex:column>

                <apex:column headerValue="{! $ObjectType.Doctor__c.fields.Name.label }"
                             value="{! oneDoctor.nameWrapper }"/>

                <apex:column headerValue="{! $ObjectType.Doctor__c.fields.FirstName__c.Label }"
                             value="{! oneDoctor.firstNameWrapper }"/>

                <apex:column headerValue="{! $ObjectType.Doctor__c.fields.City__c.Label }"
                             value="{! oneDoctor.cityWrapper }"/>

                <apex:column headerValue="{! $ObjectType.Doctor__c.fields.Country__c.Label }"
                             value="{! oneDoctor.countryWrapper }"/>

                <apex:column headerValue="{! $Label.Status }"
                             value="{! oneDoctor.statusWrapper }"/>

            </apex:pageBlockTable>


            <apex:outputPanel rendered="{! !doctorsFromFile.empty }">

                <div style="text-align: center;">

                    <apex:commandButton action="{! importCheckedDoctors }"
                                        value="{! $Label.Import }"
                                        reRender="apexForm"
                                        status="statusComp"/>

                    <apex:commandButton action="{! clear }"
                                        value="{! $Label.Clear }"
                                        reRender="apexForm"
                                        status="statusComp"/>

                    <apex:actionRegion id="actionImport"
                                       renderRegionOnly="false"/>
                </div>
            </apex:outputPanel>
        </apex:pageBlock>
    </apex:form>

    <c:Hosp_StatusComponent/>

</apex:page>